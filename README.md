The Haskell package "[filestore](https://hackage.haskell.org/package/filestore)" provides an interface for a versioning file store. It uses git, Darcs and Mercurial as a backend. Here's a short walk-through to get you started. 

See the blog entry on [mcmayer.net](http://www.mcmayer.net/a-short-haskell-filestore-tutorial/).